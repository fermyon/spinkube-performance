{"title":"SpinKube Performance","description":"[[suggested_dashboards]]","widgets":[{"id":6216570552907024,"definition":{"title":"Server Stats","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":3880385114575046,"definition":{"title":"Total Memory on Apps Node","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:system.mem.total{kube_node:aks-apps*,$host}","aggregator":"avg"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":7839166250170976,"definition":{"title":"Total Cores on Apps Node","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:system.cpu.num_cores{host:aks-apps*,$host}","aggregator":"avg"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":0,"width":4,"height":2}},{"id":3295540770224360,"definition":{"type":"note","content":"As this is time series data, be sure to navigate to this dashboard from a link generated from a successful test run in the testing repository: https://github.com/fermyon/spinkube-performance/actions/workflows/aks.yaml","background_color":"white","font_size":"18","text_align":"center","vertical_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":8,"y":0,"width":3,"height":3}}]},"layout":{"x":0,"y":0,"width":12,"height":4}},{"id":8162937284789142,"definition":{"title":"Language Performance","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":8841592702187282,"definition":{"title":"Avg HTTP Request Duration by Language","type":"toplist","requests":[{"queries":[{"data_source":"metrics","name":"query1","query":"avg:k6.http_req_duration.avg{$node_os,$node_arch,$node_instance_type, test_name:hello-world} by {language}","aggregator":"avg"}],"response_format":"scalar","formulas":[{"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"asc"}]}}],"style":{"display":{"type":"stacked","legend":"automatic"},"palette":"datadog16"}},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":5303906756294638,"definition":{"title":"Average Memory Usage per Go Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.memory.usage{$host, pod_name:hello-world-go*}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":0,"width":4,"height":2}},{"id":3617455983192156,"definition":{"title":"Average CPU Usage per Go Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.cpu.usage.total{host:aks-apps*,pod_name:hello-world-go*,$host}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":8,"y":0,"width":4,"height":2}},{"id":7165648854450872,"definition":{"title":"Median HTTP Request Duration by Language","type":"toplist","requests":[{"queries":[{"data_source":"metrics","name":"query1","query":"avg:k6.http_req_duration.median{$node_os,$node_arch,$node_instance_type, test_name:hello-world} by {language}","aggregator":"avg"}],"response_format":"scalar","formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"millisecond"},"unit_scale":{"type":"canonical_unit","unit_name":"millisecond"}},"formula":"query1"}],"sort":{"count":10,"order_by":[{"type":"formula","index":0,"order":"asc"}]}}],"style":{"display":{"type":"stacked","legend":"automatic"},"palette":"datadog16"}},"layout":{"x":0,"y":2,"width":4,"height":2}},{"id":1187498391411966,"definition":{"title":"Average Memory Usage per Python Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.memory.usage{host:aks-apps*,pod_name:hello-world-py*,$host}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":2,"width":4,"height":2}},{"id":5441223394963126,"definition":{"title":"Average CPU Usage per Python Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.cpu.usage.total{host:aks-apps*,pod_name:hello-world-py*,$host}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":8,"y":2,"width":4,"height":2}},{"id":5126284507750624,"definition":{"title":"Average Memory Usage per Rust Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.memory.usage{host:aks-apps*,pod_name:hello-world-rust*,$host}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":4,"width":4,"height":2}},{"id":6771872053201912,"definition":{"title":"Average CPU Usage per Rust Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.cpu.usage.total{host:aks-apps*,pod_name:hello-world-rust*,$host}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":8,"y":4,"width":4,"height":2}},{"id":8658484543505466,"definition":{"title":"Average Memory Usage per JS Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.memory.usage{host:aks-apps*,pod_name:hello-world-js*,$host}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":6,"width":4,"height":2}},{"id":7756002977285522,"definition":{"title":"Average CPU Usage per JS Spin App","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.cpu.usage.total{host:aks-apps*,pod_name:hello-world-js*,$host}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":8,"y":6,"width":4,"height":2}}]},"layout":{"x":0,"y":4,"width":12,"height":9}},{"id":6092429734568178,"definition":{"title":"Density","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":3408143586542864,"definition":{"title":"HTTP Request Duration by Pod Count","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query2"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:kubernetes_state.pod.count{kube_deployment:density-*, $host} by {host}"},{"name":"query2","data_source":"metrics","query":"avg:k6.http_req_duration.avg{$node_os,$node_arch,$node_instance_type, test_name:density}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":4085053660368302,"definition":{"title":"Sum of Memory Usage of Cyclotron Pod","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"sum:kubernetes.memory.usage{host:aks-apps*,pod_name:cyclotron-compute-pool-* ,$host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":4,"y":0,"width":4,"height":2}},{"id":1838300902807822,"definition":{"title":"HTTP Request Duration by Number of Apps Deployed (Avg)","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.http_req_duration.avg{$node_os,$node_arch,$node_instance_type, test_name:density} by {number_of_apps}","aggregator":"avg"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":8,"y":0,"width":4,"height":3}},{"id":3516255145081404,"definition":{"title":"Memory Usage of Apps Node","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"avg:system.mem.used{$host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}]},"layout":{"x":0,"y":2,"width":4,"height":2}},{"id":7476118261450882,"definition":{"title":"Time to Deploy 10 Apps by Destination Application Count","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.time_to_deploy_10_apps{$node_os,$node_arch,$node_instance_type, test_name:density} by {number_of_apps}","aggregator":"avg"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":4,"y":2,"width":4,"height":2}},{"id":1478020973794760,"definition":{"title":"HTTP Request Duration by Number of Apps Deployed (Median)","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.http_req_duration.median{$node_os,$node_arch,$node_instance_type, test_name:density} by {number_of_apps}","aggregator":"avg"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":8,"y":3,"width":4,"height":3}},{"id":6857814093659894,"definition":{"title":"HTTP Request Duration by Number of Apps Deployed (Median)","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.http_req_duration.95percentile{$node_os,$node_arch,$node_instance_type, test_name:density} by {number_of_apps}","aggregator":"avg"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":8,"y":6,"width":4,"height":3}}]},"layout":{"x":0,"y":13,"width":12,"height":10,"is_column_break":true}},{"id":5787660671903200,"definition":{"title":"Ramping Request Rate (by increasing VUs)","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":8143955277415362,"definition":{"title":"Requests per second by scenario","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query2"}],"queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.http_reqs{scenario:ramp,$node_os,$node_arch,$node_instance_type} by {scenario,replicas}.as_rate()"},{"name":"query2","data_source":"metrics","query":"avg:k6.http_req_duration.avg{scenario:ramp,$node_os,$node_arch,$node_instance_type} by {scenario,replicas}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":612351228623970,"definition":{"title":"CPU Usage of Apps Node","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query3"}],"queries":[{"name":"query1","data_source":"metrics","query":"system.cpu.system{$host}"},{"name":"query3","data_source":"metrics","query":"system.cpu.user{$host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}]},"layout":{"x":4,"y":0,"width":4,"height":2}},{"id":8131801938996350,"definition":{"title":"CPU Usage of Apps Node","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"avg:container.cpu.usage{$host} by {container_name}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}]},"layout":{"x":8,"y":0,"width":4,"height":2}},{"id":7761931004324782,"definition":{"title":"VUs","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.vus{$node_os,$node_arch,$node_instance_type, test_name:ramping-vus}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":4,"height":2}},{"id":6151782000564030,"definition":{"title":"CPU Usage of Apps Node","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"},{"formula":"query2"}],"queries":[{"name":"query1","data_source":"metrics","query":"avg:kubernetes.cpu.system.total{$host}"},{"name":"query2","data_source":"metrics","query":"avg:container.cpu.usage{$host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"area"}]},"layout":{"x":4,"y":2,"width":4,"height":2}},{"id":7714617885168420,"definition":{"title":"Average Memory Usage per Spin App","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.memory.usage{host:aks-apps*,pod_name:ramping-vus*,$host}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":8,"y":2,"width":4,"height":2}}]},"layout":{"x":0,"y":23,"width":12,"height":5}},{"id":7893286157929002,"definition":{"title":"Baseline","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":7166464152223064,"definition":{"title":"HTTP Requests Handled in 30s","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"sum:k6.http_reqs{test_name:constant-vus,$test_id, $node_os, $node_instance_type, $node_arch}.as_count()","aggregator":"sum"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"bars"}},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":4369797162468698,"definition":{"title":"VUs","title_size":"16","title_align":"left","type":"query_value","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.vus_max{test_name:constant-vus, $node_os, $node_arch, $node_instance_type}","aggregator":"avg"}],"formulas":[{"formula":"query1"}]}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":4,"y":0,"width":2,"height":2}},{"id":670069069295124,"definition":{"type":"note","content":"Requests in 30 seconds with 0.1s delay between requests","background_color":"yellow","font_size":"24","text_align":"left","vertical_align":"center","show_tick":true,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":6,"y":0,"width":3,"height":2}},{"id":5372477483844912,"definition":{"title":"Median HTTP Request Duration","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"data_source":"metrics","name":"query1","query":"avg:k6.http_req_duration.median{$node_os,$node_arch,$node_instance_type, test_name:constant-vus}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":0,"y":2,"width":4,"height":2}}]},"layout":{"x":0,"y":28,"width":12,"height":5}},{"id":1000736231240742,"definition":{"title":"Resource Intensive","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":105443762132776,"definition":{"title":"CPU Usage","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:container.cpu.usage{$host, pod_name:resource-intensive*}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":0,"y":0,"width":4,"height":2}},{"id":4029392170446792,"definition":{"title":"Median Request Duration for I/O Intensive Request","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query1","data_source":"metrics","query":"avg:k6.http_req_duration.median{$node_os,$node_arch,$node_instance_type, test_name:resource-intensive} by {sleepms}","aggregator":"avg"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":4,"y":0,"width":4,"height":2}},{"id":3687550600700242,"definition":{"title":"Median Request Duration for CPU Intensive Request","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query2","data_source":"metrics","query":"avg:k6.http_req_duration.median{$node_os,$node_arch,$node_instance_type, test_name:resource-intensive} by {cpuiter}","aggregator":"avg"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","formula":"query2"}]}],"has_search_bar":"auto"},"layout":{"x":8,"y":0,"width":4,"height":2}},{"id":3873576020611202,"definition":{"title":"Memory Usage","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query2"}],"queries":[{"name":"query2","data_source":"metrics","query":"avg:kubernetes.memory.usage{$host, pod_name:resource-intensive*}","aggregator":"avg"}],"response_format":"scalar"}],"autoscale":true,"precision":2,"timeseries_background":{"type":"area"}},"layout":{"x":0,"y":2,"width":4,"height":2}},{"id":974600582892230,"definition":{"title":"Median Request Duration for Memory Intensive Request","title_size":"16","title_align":"left","type":"query_table","requests":[{"response_format":"scalar","queries":[{"name":"query3","data_source":"metrics","query":"avg:k6.http_req_duration.median{$node_os,$node_arch,$node_instance_type, test_name:resource-intensive} by {memorykib}","aggregator":"avg"}],"sort":{"count":500,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","formula":"query3"}]}],"has_search_bar":"auto"},"layout":{"x":8,"y":2,"width":4,"height":2}}]},"layout":{"x":0,"y":33,"width":12,"height":5}},{"id":2121061885054960,"definition":{"title":"Playground","show_title":true,"type":"group","layout_type":"ordered","widgets":[]},"layout":{"x":0,"y":38,"width":12,"height":1}}],"template_variables":[{"name":"node_os","prefix":"node_os","available_values":[],"default":"*"},{"name":"node_arch","prefix":"node_arch","available_values":[],"default":"*"},{"name":"node_instance_type","prefix":"node_instance_type","available_values":[],"default":"*"},{"name":"host","prefix":"host","available_values":[],"default":"*"},{"name":"test_id","prefix":"test_id","available_values":[],"default":"*"}],"layout_type":"ordered","notify_list":[],"template_variable_presets":[],"reflow_type":"fixed"}